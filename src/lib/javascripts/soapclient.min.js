function SOAPClientParameters(){var t=[];this.add=function(i,r){return t[i]=r,this},this.toXml=function(){var i="";for(var r in t)switch(typeof t[r]){case"string":case"number":case"boolean":case"object":i+="<ns1:"+r+">"+SOAPClientParameters._serialize(t[r])+"</ns1:"+r+">"}return i}}function SOAPClient(){}SOAPClientParameters._serialize=function(t){var i="";switch(typeof t){case"string":i+=t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");break;case"number":case"boolean":i+=""+t;break;case"object":if((""+t.constructor).indexOf("function Date()")>-1){var r=""+t.getFullYear(),n=""+(t.getMonth()+1);n=1==n.length?"0"+n:n;var e=""+t.getDate();e=1==e.length?"0"+e:e;var o=""+t.getHours();o=1==o.length?"0"+o:o;var s=""+t.getMinutes();s=1==s.length?"0"+s:s;var h=""+t.getSeconds();h=1==h.length?"0"+h:h;for(var p=""+t.getMilliseconds(),a=Math.abs(t.getTimezoneOffset()),u=0;a>=60;)u++,a-=60;a=1==(""+a).length?"0"+a:""+a,u=1==(""+u).length?"0"+u:""+u;var g=(t.getTimezoneOffset()<0?"+":"-")+u+":"+a;i+=r+"-"+n+"-"+e+"T"+o+":"+s+":"+h+"."+p+g}else if((""+t.constructor).indexOf("function Array()")>-1)for(var f in t)if(isNaN(f))if(f.indexOf("attr")<0)if(f.indexOf("ar_at")<0)i+="_"==f?SOAPClientParameters._serialize(t[f]):"<ns1:"+f+">"+SOAPClientParameters._serialize(t[f])+"</ns1:"+f+">";else for(var l in t[f])i+="<ns1:"+f.replace("_ar_at","")+SOAPClientParameters._setAttribute(t[f][l].attr)+">"+SOAPClientParameters._serialize(t[f][l])+"</ns1:"+f.replace("_ar_at","")+">";else"attr"!=f&&(i+="<ns1:"+f.replace("_attr","")+SOAPClientParameters._setAttribute(t[f].attr)+">"+SOAPClientParameters._serialize(t[f])+"</ns1:"+f.replace("_attr","")+">");else{/function\s+(\w*)\s*\(/gi.exec(""+t[f].constructor);var c=RegExp.$1;switch(c){case"":c=typeof t[f];case"String":c="string";break;case"Number":c="int";break;case"Boolean":c="bool";break;case"Date":c="DateTime"}i+="<"+c+">"+SOAPClientParameters._serialize(t[f])+"</"+c+">"}else for(var f in t)i+="<"+f+">"+SOAPClientParameters._serialize(t[f])+"</"+f+">"}return i},SOAPClientParameters._setAttribute=function(t){var i="";for(var r in t)i+=" "+r+'="'+t[r]+'"';return i},SOAPClient.username=null,SOAPClient.password=null,SOAPClient.invoke=function(t,i,r,n,e){return n?void SOAPClient._loadWsdl(t,i,r,n,e):SOAPClient._loadWsdl(t,i,r,n,e)},SOAPClient_cacheWsdl=[],SOAPClient._loadWsdl=function(t,i,r,n,e){var o=SOAPClient_cacheWsdl[t];if(o+""!=""&&o+""!="undefined")return SOAPClient._sendSoapRequest(t,i,r,n,e,o);var s=SOAPClient._getXmlHttp();return s.open("GET",t+"?wsdl",n),n&&(s.onreadystatechange=function(){4==s.readyState&&SOAPClient._onLoadWsdl(t,i,r,n,e,s)}),s.send(null),n?void 0:SOAPClient._onLoadWsdl(t,i,r,n,e,s)},SOAPClient._onLoadWsdl=function(t,i,r,n,e,o){var s=o.responseXML;return SOAPClient_cacheWsdl[t]=s,SOAPClient._sendSoapRequest(t,i,r,n,e,s)},SOAPClient._sendSoapRequest=function(t,i,r,n,e,o){var s=o.documentElement.attributes.targetNamespace+""=="undefined"?o.documentElement.attributes.getNamedItem("targetNamespace").nodeValue:o.documentElement.attributes.targetNamespace.value,h='<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ns1="http://gutp.jp/fiap/2009/11/" xmlns:ns2="'+s+'" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"><soap:Body><ns2:'+i+' xmlns="'+s+'">'+r.toXml()+"</ns2:"+i+"></soap:Body></soap:Envelope>",p=SOAPClient._getXmlHttp();SOAPClient.userName&&SOAPClient.password?(p.open("POST",t,n,SOAPClient.userName,SOAPClient.password),p.setRequestHeader("Authorization","Basic "+SOAPClient._toBase64(SOAPClient.userName+":"+SOAPClient.password))):p.open("POST",t,n);var a=(s.lastIndexOf("/")!=s.length-1?s+"/":s)+i;return p.setRequestHeader("SOAPAction",a),p.setRequestHeader("Content-Type","text/xml; charset=utf-8"),n&&(p.onreadystatechange=function(){4==p.readyState&&SOAPClient._onSendSoapRequest(i,n,e,o,p)}),n&&(p.timeout=1e4,p.ontimeout=function(){$("#query_alert").fadeIn(),console.log("send request again?")}),p.send(h),n?void 0:SOAPClient._onSendSoapRequest(i,n,e,o,p)},SOAPClient._onSendSoapRequest=function(t,i,r,n,e){200!=e.status&&console.log("Send Request Failed");var o=null,s=SOAPClient._getElementsByTagName(e.responseXML,t+"RS");if(0==s.length&&(s=SOAPClient._getElementsByTagName(e.responseXML,"ns2:"+t+"RS")),0==s.length&&(s=SOAPClient._getElementsByTagName(e.responseXML,"return")),0==s.length){if(e.responseXML.getElementsByTagName("faultcode").length>0){if(!i&&!r)throw Error(500,e.responseXML.getElementsByTagName("faultstring")[0].childNodes[0].nodeValue);o=Error(500,e.responseXML.getElementsByTagName("faultstring")[0].childNodes[0].nodeValue)}}else o=SOAPClient._soapresult2object(s[0],n);return r&&r(o,e.responseXML),i?void 0:o},SOAPClient._soapresult2object=function(t,i){var r=SOAPClient._getTypesFromWsdl(i);return SOAPClient._node2object(t,r)},SOAPClient._node2object=function(t,i){if(null==t)return null;if(3==t.nodeType||4==t.nodeType)return SOAPClient._extractValue(t,i);if(1==t.childNodes.length&&(3==t.childNodes[0].nodeType||4==t.childNodes[0].nodeType))return SOAPClient._node2object(t.childNodes[0],i);var r=-1!=SOAPClient._getTypeFromWsdl(t.nodeName,i).toLowerCase().indexOf("arrayof");if(r){for(var n=[],e=0;e<t.childNodes.length;e++)n[n.length]=SOAPClient._node2object(t.childNodes[e],i);return n}var o=null;t.hasChildNodes()&&(o={},"point"==t.nodeName&&(o.value=[],o.time=[]),"pointSet"==t.nodeName&&(o.id=[],o.pointSet={},o.point={}),"query"==t.nodeName&&(o[t.childNodes[0].nodeName]={},o[t.childNodes[0].nodeName].id=[]),"body"==t.nodeName&&(o.id=[],o[t.childNodes[0].nodeName]={}));for(var e=0;e<t.childNodes.length;e++){var s=SOAPClient._node2object(t.childNodes[e],i);"point"==t.nodeName&&"value"==t.childNodes[e].nodeName?(o.value.push(s),o.time.push(t.childNodes[e].getAttribute("time"))):"pointSet"==t.nodeName?(o[t.childNodes[e].nodeName][t.childNodes[e].getAttribute("id")]=s,o.id.push(t.childNodes[e].getAttribute("id"))):"body"!=t.nodeName||"point"!=t.childNodes[e].nodeName&&"pointSet"!=t.childNodes[e].nodeName?"header"==t.nodeName&&"query"==t.childNodes[e].nodeName?(o[t.childNodes[e].nodeName]={},o[t.childNodes[e].nodeName].id=t.childNodes[e].getAttribute("id"),o[t.childNodes[e].nodeName].cursor=t.childNodes[e].getAttribute("cursor"),o[t.childNodes[e].nodeName]._=s):"query"==t.nodeName&&"key"==t.childNodes[e].nodeName?o[t.childNodes[e].nodeName].id[e]=t.childNodes[e].getAttribute("id"):o[t.childNodes[e].nodeName]=s:o.point.hasOwnProperty(t.childNodes[e].getAttribute("id"))?null!==o.point[t.childNodes[e].getAttribute("id")]&&null!==s&&(o.point[t.childNodes[e].getAttribute("id")].value=o.point[t.childNodes[e].getAttribute("id")].value.concat(s.value),o.point[t.childNodes[e].getAttribute("id")].time=o.point[t.childNodes[e].getAttribute("id")].time.concat(s.time)):(o.point[t.childNodes[e].getAttribute("id")]=s,o.id.push(t.childNodes[e].getAttribute("id")))}return o},SOAPClient._extractValue=function(t,i){var r=t.nodeValue;switch(SOAPClient._getTypeFromWsdl(t.parentNode.nodeName,i).toLowerCase()){default:case"s:string":return null!=r?r+"":"";case"s:boolean":return r+""=="true";case"s:int":case"s:long":return null!=r?parseInt(r+"",10):0;case"s:double":return null!=r?parseFloat(r+""):0;case"s:datetime":if(null==r)return null;r+="",r=r.substring(0,-1==r.lastIndexOf(".")?r.length:r.lastIndexOf(".")),r=r.replace(/T/gi," "),r=r.replace(/-/gi,"/");var n=new Date;return n.setTime(Date.parse(r)),n}},SOAPClient._getTypesFromWsdl=function(t){var i=[],r=t.getElementsByTagName("s:element"),n=!0;0==r.length&&(r=t.getElementsByTagName("element"),n=!1);for(var e=0;e<r.length;e++)n?null!=r[e].attributes.getNamedItem("name")&&null!=r[e].attributes.getNamedItem("type")&&(i[r[e].attributes.getNamedItem("name").nodeValue]=r[e].attributes.getNamedItem("type").nodeValue):null!=r[e].attributes.name&&null!=r[e].attributes.type&&(i[r[e].attributes.name.value]=r[e].attributes.type.value);return i},SOAPClient._getTypeFromWsdl=function(t,i){var r=i[t]+"";return"undefined"==r?"":r},SOAPClient._getElementsByTagName=function(t,i){try{return t.selectNodes('.//*[local-name()="'+i+'"]')}catch(r){}return t.getElementsByTagName(i)},SOAPClient._getXmlHttp=function(){try{if(window.XMLHttpRequest){var t=new XMLHttpRequest;return null==t.readyState&&(t.readyState=1,t.addEventListener("load",function(){t.readyState=4,"function"==typeof t.onreadystatechange&&t.onreadystatechange()},!1)),t}if(window.ActiveXObject)return new ActiveXObject(SOAPClient._getXmlHttpProgID())}catch(i){}throw Error("Your browser does not support XmlHttp objects")},SOAPClient._getXmlHttpProgID=function(){if(SOAPClient._getXmlHttpProgID.progid)return SOAPClient._getXmlHttpProgID.progid;for(var t,i=["Msxml2.XMLHTTP.5.0","Msxml2.XMLHTTP.4.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],r=0;r<i.length;r++)try{return t=new ActiveXObject(i[r]),SOAPClient._getXmlHttpProgID.progid=i[r]}catch(n){}throw Error("Could not find an installed XML parser")},SOAPClient._toBase64=function(t){var i,r,n,e,o,s,h,p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",a="",u=0;do i=t.charCodeAt(u++),r=t.charCodeAt(u++),n=t.charCodeAt(u++),e=i>>2,o=(3&i)<<4|r>>4,s=(15&r)<<2|n>>6,h=63&n,isNaN(r)?s=h=64:isNaN(n)&&(h=64),a=a+p.charAt(e)+p.charAt(o)+p.charAt(s)+p.charAt(h);while(u<t.length);return a};
